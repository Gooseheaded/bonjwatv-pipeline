@page
@model bwkt_webapp.Pages.Account.LoginModel
@{
    ViewData["Title"] = "Login";
}

<h1>Login</h1>
<p>Sign in with Discord to enable ratings and future contributions.</p>

@{
    var clientId = Environment.GetEnvironmentVariable("DISCORD_CLIENT_ID");
    var callback = Environment.GetEnvironmentVariable("OAUTH_CALLBACK_URL") ?? (Request.Scheme + "://" + Request.Host + "/account/callback");
    var authorizeUrl = string.IsNullOrEmpty(clientId)
        ? "/account/callback?code=demo" // skeleton fallback
        : $"https://discord.com/oauth2/authorize?response_type=code&client_id={clientId}&scope=identify&redirect_uri={Uri.EscapeDataString(callback)}";
}

<a class="btn btn-primary" href="@authorizeUrl">Login with Discord</a>
